webpackJsonp([0],{1520:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,s,o=r(2),i=a(o),c=r(56),u=a(c),d=r(5),f=a(d),p=r(10),m=a(p),l=r(7),h=a(l),v=r(8),k=a(v),b=r(0),w=(a(b),r(272)),x=r(602),y=a(x),A=(n=(0,w.wrapper)(y.default))(s=function(e){function t(){return(0,f.default)(this,t),(0,h.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,k.default)(t,e),(0,m.default)(t,[{key:"render",value:function(){return this.props.monkeyKing((0,i.default)({},this.props,{path:"root"}))}}]),t}(b.Component))||s;t.default=A,e.exports=t.default},1521:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=new v.action(e),r=new y((0,o.default)({},e,{metaAction:t})),a=(0,o.default)({},t,r);return t.config({metaHandlers:a}),a}Object.defineProperty(t,"__esModule",{value:!0});var s=r(2),o=a(s),i=r(53),c=a(i),u=r(273),d=a(u),f=r(274),p=a(f),m=r(5),l=a(m);t.default=n;var h=r(0),v=(a(h),r(272)),k=r(78),b=r(9),w=(a(b),r(601)),x=a(w),y=function e(t){var r=this;(0,l.default)(this,e),this.onInit=function(e){var t=e.component,a=e.injections;r.component=t,r.injections=a,r.component.props.setOkListener&&r.component.props.setOkListener(r.onOk),a.reduce("init",{isPop:r.component.props.isPop}),r.load()},this.load=(0,p.default)(d.default.mark(function e(){var t,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,r.webapi.department.query();case 3:if(a=e.sent,t.departments=a,!r.component.props.personId&&0!=r.component.props.personId){e.next=10;break}return e.next=8,r.webapi.person.findById(r.component.props.personId);case 8:a=e.sent,t.person=a;case 10:r.injections.reduce("load",t);case 11:case"end":return e.stop()}},e,r)})),this.onOk=function(){return new c.default(function(){var e=(0,p.default)(d.default.mark(function e(t,a){var n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.save();case 2:n=e.sent,t(!1===n?!1:!0);case 4:case"end":return e.stop()}},e,r)}));return function(t,r){return e.apply(this,arguments)}}())},this.save=(0,p.default)(d.default.mark(function e(){var t,a,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("error"!=r.checkName(!0).status&&"error"!=r.checkMobile(!0).status){e.next=3;break}return r.injections.reduce("setCheckFields",["data.form.name","data.form.sex","data.form.mobile","data.form.birthday"]),e.abrupt("return",!1);case 3:if(t=r.metaAction.gf("data.form").toJS(),t.birthday=t.birthday.format("YYYY-MM-DD"),!t.id&&0!=t.id){e.next=12;break}return e.next=8,r.webapi.person.update(t);case 8:a=e.sent,a&&(r.metaAction.toast("success","保存人员成功"),r.injections.reduce("setPerson",a)),e.next=16;break;case 12:return e.next=14,r.webapi.person.create(t);case 14:n=e.sent,n&&(r.metaAction.toast("success","保存人员成功"),r.injections.reduce("setPerson",n));case 16:case"end":return e.stop()}},e,r)})),this.add=function(){r.injections.reduce("setPerson",{id:void 0,name:"",sex:"0",birthday:"1980-01-01",mobile:"",dept:void 0,address:"北京海淀"})},this.prev=(0,p.default)(d.default.mark(function e(){var t,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.metaAction.gf("data.form.id"),e.next=3,r.webapi.person.prev(t);case 3:a=e.sent,a&&r.injections.reduce("setPerson",a);case 5:case"end":return e.stop()}},e,r)})),this.next=(0,p.default)(d.default.mark(function e(){var t,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.metaAction.gf("data.form.id"),e.next=3,r.webapi.person.next(t);case 3:a=e.sent,a&&r.injections.reduce("setPerson",a);case 5:case"end":return e.stop()}},e,r)})),this.checkName=function(e){var t=r.metaAction.gf("data.other.checkFields")||(0,k.List)();return!0===e||t.includes("data.form.name")?r.metaAction.gf("data.form.name")?{status:"success"}:{status:"error",message:"请录入姓名"}:{}},this.checkMobile=function(e){var t=r.metaAction.gf("data.other.checkFields")||(0,k.List)();return!0===e||t.includes("data.form.mobile")?r.metaAction.gf("data.form.mobile")?{status:"success"}:{status:"error",message:"请录入手机号"}:{}},this.departmentFocus=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.webapi.department.query();case 2:t=e.sent,r.metaAction.sf("data.other.departments",(0,k.fromJS)(t));case 4:case"end":return e.stop()}},e,r)})),this.addDepartment=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.config.apps["mk-app-department-card"]){e.next=2;break}throw"依赖mk-app-department-card app,请使用mk clone mk-app-department-card命令添加";case 2:return e.next=4,r.metaAction.modal("show",{title:"新增部门",children:r.metaAction.loadApp("mk-app-department-card",{store:r.component.props.store})});case 4:t=e.sent,t&&r.injections.reduce("addDepartment",t);case 6:case"end":return e.stop()}},e,r)})),this.metaAction=t.metaAction,this.config=x.default.current,this.webapi=this.config.webapi};e.exports=t.default},1522:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=new m.reducer(e),r=new k((0,u.default)({},e,{metaReducer:t}));return(0,u.default)({},t,r)}Object.defineProperty(t,"__esModule",{value:!0});var s,o,i,c=r(2),u=a(c),d=r(5),f=a(d);t.default=n;var p=r(78),m=r(272),l=r(601),h=(a(l),r(9)),v=a(h),k=(o=s=function e(t){(0,f.default)(this,e),i.call(this),this.metaReducer=t.metaReducer},i=function(){var e=this;this.init=function(t,r){var a={data:{form:{name:"",sex:"0",birthday:(0,v.default)("1981-1-1"),mobile:"",department:"",address:"北京海淀"},other:{departments:[]}}};return a.data.other.isPop=!!r.isPop,e.metaReducer.init(t,a)},this.load=function(t,r){var a=r.person,n=r.departments;return a&&(t=e.metaReducer.sf(t,"data.form",(0,p.fromJS)((0,u.default)({},a,{birthday:(0,v.default)(a.birthday)})))),e.metaReducer.sf(t,"data.other.departments",(0,p.fromJS)(n))},this.setPerson=function(t,r){return t=e.metaReducer.sf(t,"data.form",(0,p.fromJS)((0,u.default)({},r,{birthday:(0,v.default)(r.birthday)}))),e.metaReducer.sf(t,"data.other.checkFields",(0,p.List)())},this.setField=function(t,r,a){return t=e.metaReducer.setField(t,r,a),e.setCheckFields(t,r)},this.setCheckFields=function(t,r){if(!r)return t;var a=e.metaReducer.gf(t,"data.other.checkFields")||(0,p.List)();return"string"==typeof r?(a=a.includes(r)?a:a.push(r),e.metaReducer.sf(t,"data.other.checkFields",a)):r instanceof Array?(r.forEach(function(e){a=a.includes(e)?a:a.push(e)}),e.metaReducer.sf(t,"data.other.checkFields",a)):t},this.addDepartment=function(t,r){var a=(r.id,r.code);r.name;return e.metaReducer.sf(t,"data.form.department",a)}},o);e.exports=t.default}});